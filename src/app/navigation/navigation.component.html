<nav>
  <!-- Mobile Menu Toggle Button -->
  <button (click)="toggleMenu()" class="menu-toggle" aria-label="Toggle menu">
    {{ isMenuOpen ? 'Close' : 'Menu' }}
  </button>

  <ul class="nav-list" [class.open]="isMenuOpen">
    <li><a routerLink="/home" (click)="closeMenu()">Home</a></li>

    <!-- Stakeholder Menus -->
    <ng-container *ngIf="userActiveRole === userType.StakeHolder">
      <li>
        <button mat-button [matMenuTriggerFor]="stakeholderFindMenu" class="menu-trigger">Find School/Office</button>
        <mat-menu #stakeholderFindMenu="matMenu">
          <button mat-menu-item [matMenuTriggerFor]="stakeholderSchoolSubmenu">School</button>
          <mat-menu #stakeholderSchoolSubmenu="matMenu">
            <button mat-menu-item [routerLink]="['/stakeholder/all-school']" (click)="closeMenu()">All</button>
            <button mat-menu-item [routerLink]="['/stakeholder/districts']" (click)="closeMenu()">By District</button>
          </mat-menu>
          <button mat-menu-item [routerLink]="['/stakeholder/offices']" (click)="closeMenu()" disabled>Office</button>
        </mat-menu>
      </li>
      <li><a routerLink="about-us" (click)="closeMenu()">About  Us </a></li>
      <li><a routerLink="stakeholder/my-contribution" (click)="closeMenu()">My Contribution</a></li>
      <li><a routerLink="/stakeholder/generated-resources" (click)="closeMenu()">Generated Resources</a></li>
      <li *ngIf="currentTenant === tenant.GENSAN">
        <button mat-button [matMenuTriggerFor]="stakeholderSupportMenu" class="menu-trigger">Support</button>
        <mat-menu #stakeholderSupportMenu="matMenu">
          <a mat-menu-item href="https://sites.google.com/deped.gov.ph/depedgensansmn/home"
             target="_blank" rel="noopener noreferrer">Partners Support</a>
        </mat-menu>
      </li>
    </ng-container>

    <!-- School Admin Menus -->
    <ng-container *ngIf="userActiveRole === userType.SchoolAdmin">
      <li>
        <button mat-button [matMenuTriggerFor]="schoolAdminSchoolNeedsMenu" class="menu-trigger">School Needs</button>
        <mat-menu #schoolAdminSchoolNeedsMenu="matMenu">
          <button mat-menu-item [routerLink]="['/school-admin/list-of-school-needs']" (click)="closeMenu()">List of School Needs</button>
          <button mat-menu-item disabled>Senior High School</button>
        </mat-menu>
      </li>

      <li><a routerLink="/school-admin/aip" (click)="closeMenu()">AIP</a></li>
      <li><a href="https://partnershipsdatabase.deped.gov.ph/" target="_blank" rel="noopener noreferrer"
             (click)="closeMenu()">DPDS</a></li>
      <li><a routerLink="/school-admin/quick-count" (click)="closeMenu()" >Quick Count</a></li>
      <li><a routerLink="/school-admin/reports" (click)="closeMenu()" class="disabled"
             style="pointer-events: none; color: #ccc; cursor: not-allowed;">Reports</a></li>
      <li *ngIf="currentTenant === tenant.GENSAN">
        <button mat-button [matMenuTriggerFor]="schoolAdminSupportMenu" class="menu-trigger">Support</button>
        <mat-menu #schoolAdminSupportMenu="matMenu">
          <a mat-menu-item href="https://sites.google.com/deped.gov.ph/spfp-support/home"
             target="_blank" rel="noopener noreferrer">SPFP Support</a>
        </mat-menu>
      </li>
      <li><a routerLink="about-us" (click)="closeMenu()">About Us</a></li>

    </ng-container>

    <!-- Division Admin Menus -->
    <ng-container *ngIf="userActiveRole === 'divisionAdmin'">
      <li><a routerLink="about-us" (click)="closeMenu()">About Us</a></li>
      <li *ngIf="currentTenant === tenant.GENSAN">
        <button mat-button [matMenuTriggerFor]="divisionAdminSupportMenu" class="menu-trigger">Support</button>
        <mat-menu #divisionAdminSupportMenu="matMenu">
          <button mat-menu-item [routerLink]="['/division-admin/partners-support']" (click)="closeMenu()">Partner Support</button>
        </mat-menu>
      </li>
      <li><a routerLink="/division-admin/reports" (click)="closeMenu()">Reports</a></li>
      <li><a routerLink="/division-admin/generated-resources" (click)="closeMenu()">Generated Resources</a></li>
      <li>
        <button mat-button [matMenuTriggerFor]="divisionAdminAdministrationMenu" class="menu-trigger">Administration</button>
        <mat-menu #divisionAdminAdministrationMenu="matMenu">
          <button mat-menu-item [routerLink]="['/division-admin/add-district']" (click)="closeMenu()">Add District</button>
          <button mat-menu-item [routerLink]="['/division-admin/manage-users']" (click)="closeMenu()">Manage Users</button>
          <button mat-menu-item [routerLink]="['/division-admin/permission-levels']" (click)="closeMenu()">Permission Levels</button>
          <button mat-menu-item [routerLink]="['/division-admin/open-registration']" (click)="closeMenu()">Open Registration</button>
          <button mat-menu-item [routerLink]="['/division-admin/close-registration']" (click)="closeMenu()">Close Registration</button>
        </mat-menu>
      </li>
    </ng-container>

    <!-- Guest Menus - for users who are not logged in -->
    <ng-container *ngIf="!isLoggedIn()">
      <li>
        <button mat-button [matMenuTriggerFor]="guestFindMenu" class="menu-trigger">Find School/Office</button>
        <mat-menu #guestFindMenu="matMenu">
          <button mat-menu-item [matMenuTriggerFor]="guestSchoolSubmenu">School</button>
          <mat-menu #guestSchoolSubmenu="matMenu">
            <button mat-menu-item [routerLink]="['/guest/all-school']" (click)="closeMenu()">All</button>
            <button mat-menu-item [routerLink]="['/guest/districts']" (click)="closeMenu()">By District</button>
          </mat-menu>
          <button mat-menu-item [routerLink]="['/guest/offices']" (click)="closeMenu()" disabled>Office</button>
        </mat-menu>
      </li>
      <li *ngIf="currentTenant === tenant.GENSAN">
        <button mat-button [matMenuTriggerFor]="guestSupportMenu" class="menu-trigger">Support</button>
        <mat-menu #guestSupportMenu="matMenu">
          <a mat-menu-item href="https://sites.google.com/deped.gov.ph/depedgensansmn/home"
             target="_blank" rel="noopener noreferrer">Partners Support</a>
        </mat-menu>
      </li>
      <li><a routerLink="about-us" (click)="closeMenu()">About Us</a></li>
    </ng-container>
  </ul>

  <!-- Profile section -->
  <div class="profile">
    <ng-container *ngIf="isLoggedIn(); else loginButton">
      <button mat-icon-button [matMenuTriggerFor]="profileMenu" class="avatar-button">
        <div class="avatar">
          <img *ngIf="getProfileImageUrl() && !profileImageError"
               [src]="getProfileImageUrl()"
               alt="Profile"
               class="avatar-image"
               (error)="onImageError($event)">
          <span class="avatar-initials" [style.display]="hasProfileImage() ? 'none' : 'flex'">{{ getUserInitials() }}</span>
        </div>
      </button>
      <mat-menu #profileMenu="matMenu">
        <button mat-menu-item [routerLink]="['/change-password']">Change Password</button>
        <button mat-menu-item [routerLink]="['/profile']" *ngIf="userActiveRole === UserType.SchoolAdmin">Edit Profile</button>
        <button mat-menu-item *ngIf="userRoles.length > 1" (click)="openSwitchRoleDialog()">Switch Role</button>
        <button mat-menu-item class="logout-menu-item" (click)="logout()" routerLink="/sign-in">Logout</button>
      </mat-menu>
    </ng-container>
    <ng-template #loginButton>
      <button mat-raised-button color="primary" class="login-button" routerLink="/sign-in"
              *ngIf="shouldShowLoginButton()">
        Login
      </button>
    </ng-template>
  </div>
</nav>
